<script src="require.js"></script>
<!--<script src="signals.js"></script>
<script src="hasher.js"></script>
<script src="crossroads.js"></script>
<script src="chirimoya.js"></script>-->

<div id="app">
    Loading chirimoya.. Uhm delicious!
</div>

<script>
    require(['chirimoya', 'crossroads','hasher'], function(Chirimoya, crossroads, hasher){
        var chiri = new Chirimoya(null, {
            router: 1,
            routerParams: {
                crossroads:crossroads,
                hasher: hasher
            }
        });
      
        window.chiri = chiri; //TODO Self reg
        chiri.onBeforeHasAccess = function(View, moduleId){
            return new Promise(function(resolve){
                console.log('waiting 10 secs');
                if(moduleId === 'pages/home/home') return resolve(true);
                setTimeout(function() {
                     resolve(true);
                }, 10000);
            });
        };
        //chirimoya.init();
        chiri.set('home');
    });
    
</script>
